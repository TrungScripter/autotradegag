--- AUTO GIFTING SCRIPT v3.9 with SCROLLABLE GUI
-- Toggle: G
-- Auto Force Equip Bat: ON/OFF | Auto Accept Trade: ON/OFF | Auto Jump: ON/OFF

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local VIM = game:GetService("VirtualInputManager")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local backpack = player:WaitForChild("Backpack")

-- Configuration
local ENABLED = false
local HOLD_E = 0.25  -- How long to hold E
local COOLDOWN = 0.2 -- Delay between items
local SAFETY_CHECK = true -- Checks if character is alive

-- Auto Equip Bat settings
local AUTO_EQUIP_BAT_ENABLED = false
local AUTO_EQUIP_INTERVAL = 0.1 -- Check every 0.1 seconds (FAST)
local lastEquipCheck = 0

-- Auto Trade Accept settings (SIMPLIFIED)
local AUTO_TRADE_ENABLED = false
local AUTO_TRADE_INTERVAL = 0.4 
local lastTradeCheck = 0

-- Auto Jump settings
local AUTO_JUMP_ENABLED = false
local AUTO_JUMP_INTERVAL = 600 -- Jump every 600 seconds (10 minutes)
local lastJumpTime = 0

-- Item blacklist (items that cannot be gifted)
local BLACKLIST = {
    "Sword", "sword", "Weapon", "weapon",
    "Admin", "admin", "Tool",
    -- Add more as needed
}

-- Server hopping variables
local ServerHopCooldown = false
local PlaceId = game.PlaceId
local JobId = game.JobId

-- Server version tracking
local CurrentPlaceVersion = game.PlaceVersion
local LastKnownVersion = nil
local VersionCheckEnabled = true

-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AutoGiftGUI"
ScreenGui.Parent = game:GetService("CoreGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 350, 0, 450) -- Fixed height, will scroll
MainFrame.Position = UDim2.new(0.5, -175, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
MainFrame.BackgroundTransparency = 0.1
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

-- Corner
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- Title
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Text = "nguyendangtu daubuoi"
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundColor3 = Color3.fromRGB(45, 45, 60)
Title.BackgroundTransparency = 0
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.Parent = MainFrame

-- Scrollable Content Area
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Name = "ScrollFrame"
ScrollFrame.Size = UDim2.new(1, 0, 1, -50) -- Fill main frame except title
ScrollFrame.Position = UDim2.new(0, 0, 0, 50)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.BorderSizePixel = 0
ScrollFrame.ScrollBarThickness = 6
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 700) -- Total content height
ScrollFrame.VerticalScrollBarInset = Enum.ScrollBarInset.Always
ScrollFrame.Parent = MainFrame

-- Content container
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, 0, 0, 700)
ContentFrame.Position = UDim2.new(0, 0, 0, 0)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = ScrollFrame

-- Status Indicator
local StatusFrame = Instance.new("Frame")
StatusFrame.Name = "StatusFrame"
StatusFrame.Size = UDim2.new(0.9, 0, 0, 40)
StatusFrame.Position = UDim2.new(0.05, 0, 0, 10)
StatusFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
StatusFrame.BorderSizePixel = 0
StatusFrame.Parent = ContentFrame

local StatusCorner = Instance.new("UICorner")
StatusCorner.CornerRadius = UDim.new(0, 8)
StatusCorner.Parent = StatusFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Text = "STATUS: OFF"
StatusLabel.Size = UDim2.new(1, 0, 1, 0)
StatusLabel.Position = UDim2.new(0, 0, 0, 0)
StatusLabel.BackgroundTransparency = 1
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.Font = Enum.Font.GothamSemibold
StatusLabel.TextSize = 16
StatusLabel.Parent = StatusFrame

-- Toggle Button
local ToggleButton = Instance.new("TextButton")
ToggleButton.Name = "ToggleButton"
ToggleButton.Text = "START (G)"
ToggleButton.Size = UDim2.new(0.9, 0, 0, 45)
ToggleButton.Position = UDim2.new(0.05, 0, 0, 60)
ToggleButton.BackgroundColor3 = Color3.fromRGB(70, 180, 90)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.TextSize = 16
ToggleButton.Parent = ContentFrame

local ToggleCorner = Instance.new("UICorner")
ToggleCorner.CornerRadius = UDim.new(0, 8)
ToggleCorner.Parent = ToggleButton

-- Auto Equip Bat Section
local AutoEquipFrame = Instance.new("Frame")
AutoEquipFrame.Name = "AutoEquipFrame"
AutoEquipFrame.Size = UDim2.new(0.9, 0, 0, 60)
AutoEquipFrame.Position = UDim2.new(0.05, 0, 0, 115)
AutoEquipFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
AutoEquipFrame.BorderSizePixel = 0
AutoEquipFrame.Parent = ContentFrame

local AutoEquipCorner = Instance.new("UICorner")
AutoEquipCorner.CornerRadius = UDim.new(0, 8)
AutoEquipCorner.Parent = AutoEquipFrame

local AutoEquipText = Instance.new("TextLabel")
AutoEquipText.Name = "AutoEquipText"
AutoEquipText.Text = "Auto Equip Bat: OFF"
AutoEquipText.Size = UDim2.new(0.6, 0, 1, 0)
AutoEquipText.Position = UDim2.new(0.05, 0, 0, 0)
AutoEquipText.BackgroundTransparency = 1
AutoEquipText.TextColor3 = Color3.fromRGB(255, 100, 100)
AutoEquipText.Font = Enum.Font.Gotham
AutoEquipText.TextSize = 12
AutoEquipText.TextXAlignment = Enum.TextXAlignment.Left
AutoEquipText.Parent = AutoEquipFrame

local AutoEquipToggle = Instance.new("TextButton")
AutoEquipToggle.Name = "AutoEquipToggle"
AutoEquipToggle.Text = "OFF"
AutoEquipToggle.Size = UDim2.new(0.25, 0, 0.6, 0)
AutoEquipToggle.Position = UDim2.new(0.7, 0, 0.2, 0)
AutoEquipToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
AutoEquipToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoEquipToggle.Font = Enum.Font.GothamBold
AutoEquipToggle.TextSize = 12
AutoEquipToggle.Parent = AutoEquipFrame

local AutoEquipToggleCorner = Instance.new("UICorner")
AutoEquipToggleCorner.CornerRadius = UDim.new(0, 6)
AutoEquipToggleCorner.Parent = AutoEquipToggle

-- Auto Accept Trade Section
local AutoTradeFrame = Instance.new("Frame")
AutoTradeFrame.Name = "AutoTradeFrame"
AutoTradeFrame.Size = UDim2.new(0.9, 0, 0, 60)
AutoTradeFrame.Position = UDim2.new(0.05, 0, 0, 185)
AutoTradeFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
AutoTradeFrame.BorderSizePixel = 0
AutoTradeFrame.Parent = ContentFrame

local AutoTradeCorner = Instance.new("UICorner")
AutoTradeCorner.CornerRadius = UDim.new(0, 8)
AutoTradeCorner.Parent = AutoTradeFrame

local AutoTradeText = Instance.new("TextLabel")
AutoTradeText.Name = "AutoTradeText"
AutoTradeText.Text = "Auto Accept Trade: OFF"
AutoTradeText.Size = UDim2.new(0.6, 0, 1, 0)
AutoTradeText.Position = UDim2.new(0.05, 0, 0, 0)
AutoTradeText.BackgroundTransparency = 1
AutoTradeText.TextColor3 = Color3.fromRGB(255, 100, 100)
AutoTradeText.Font = Enum.Font.Gotham
AutoTradeText.TextSize = 12
AutoTradeText.TextXAlignment = Enum.TextXAlignment.Left
AutoTradeText.Parent = AutoTradeFrame

local AutoTradeToggle = Instance.new("TextButton")
AutoTradeToggle.Name = "AutoTradeToggle"
AutoTradeToggle.Text = "OFF"
AutoTradeToggle.Size = UDim2.new(0.25, 0, 0.6, 0)
AutoTradeToggle.Position = UDim2.new(0.7, 0, 0.2, 0)
AutoTradeToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
AutoTradeToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoTradeToggle.Font = Enum.Font.GothamBold
AutoTradeToggle.TextSize = 12
AutoTradeToggle.Parent = AutoTradeFrame

local AutoTradeToggleCorner = Instance.new("UICorner")
AutoTradeToggleCorner.CornerRadius = UDim.new(0, 6)
AutoTradeToggleCorner.Parent = AutoTradeToggle

-- Auto Jump Section
local AutoJumpFrame = Instance.new("Frame")
AutoJumpFrame.Name = "AutoJumpFrame"
AutoJumpFrame.Size = UDim2.new(0.9, 0, 0, 60)
AutoJumpFrame.Position = UDim2.new(0.05, 0, 0, 255)
AutoJumpFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
AutoJumpFrame.BorderSizePixel = 0
AutoJumpFrame.Parent = ContentFrame

local AutoJumpCorner = Instance.new("UICorner")
AutoJumpCorner.CornerRadius = UDim.new(0, 8)
AutoJumpCorner.Parent = AutoJumpFrame

local AutoJumpText = Instance.new("TextLabel")
AutoJumpText.Name = "AutoJumpText"
AutoJumpText.Text = "Auto Jump (10min): OFF"
AutoJumpText.Size = UDim2.new(0.6, 0, 1, 0)
AutoJumpText.Position = UDim2.new(0.05, 0, 0, 0)
AutoJumpText.BackgroundTransparency = 1
AutoJumpText.TextColor3 = Color3.fromRGB(255, 100, 100)
AutoJumpText.Font = Enum.Font.Gotham
AutoJumpText.TextSize = 12
AutoJumpText.TextXAlignment = Enum.TextXAlignment.Left
AutoJumpText.Parent = AutoJumpFrame

local AutoJumpToggle = Instance.new("TextButton")
AutoJumpToggle.Name = "AutoJumpToggle"
AutoJumpToggle.Text = "OFF"
AutoJumpToggle.Size = UDim2.new(0.25, 0, 0.6, 0)
AutoJumpToggle.Position = UDim2.new(0.7, 0, 0.2, 0)
AutoJumpToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
AutoJumpToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoJumpToggle.Font = Enum.Font.GothamBold
AutoJumpToggle.TextSize = 12
AutoJumpToggle.Parent = AutoJumpFrame

local AutoJumpToggleCorner = Instance.new("UICorner")
AutoJumpToggleCorner.CornerRadius = UDim.new(0, 6)
AutoJumpToggleCorner.Parent = AutoJumpToggle

-- Progress Section
local ProgressFrame = Instance.new("Frame")
ProgressFrame.Name = "ProgressFrame"
ProgressFrame.Size = UDim2.new(0.9, 0, 0, 80)
ProgressFrame.Position = UDim2.new(0.05, 0, 0, 325)
ProgressFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
ProgressFrame.BorderSizePixel = 0
ProgressFrame.Parent = ContentFrame

local ProgressCorner = Instance.new("UICorner")
ProgressCorner.CornerRadius = UDim.new(0, 8)
ProgressCorner.Parent = ProgressFrame

local ProgressText = Instance.new("TextLabel")
ProgressText.Name = "ProgressText"
ProgressText.Text = "Progress: 0/0"
ProgressText.Size = UDim2.new(1, 0, 0.5, 0)
ProgressText.Position = UDim2.new(0, 0, 0, 5)
ProgressText.BackgroundTransparency = 1
ProgressText.TextColor3 = Color3.fromRGB(255, 255, 255)
ProgressText.Font = Enum.Font.GothamSemibold
ProgressText.TextSize = 14
ProgressText.Parent = ProgressFrame

local CurrentItemText = Instance.new("TextLabel")
CurrentItemText.Name = "CurrentItemText"
CurrentItemText.Text = "Current: None"
CurrentItemText.Size = UDim2.new(1, 0, 0.5, 0)
CurrentItemText.Position = UDim2.new(0, 0, 0.5, 0)
CurrentItemText.BackgroundTransparency = 1
CurrentItemText.TextColor3 = Color3.fromRGB(200, 200, 255)
CurrentItemText.Font = Enum.Font.Gotham
CurrentItemText.TextSize = 12
CurrentItemText.Parent = ProgressFrame

-- Server Info Section
local ServerInfoFrame = Instance.new("Frame")
ServerInfoFrame.Name = "ServerInfoFrame"
ServerInfoFrame.Size = UDim2.new(0.9, 0, 0, 70)
ServerInfoFrame.Position = UDim2.new(0.05, 0, 0, 415)
ServerInfoFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
ServerInfoFrame.BorderSizePixel = 0
ServerInfoFrame.Parent = ContentFrame

local ServerInfoCorner = Instance.new("UICorner")
ServerInfoCorner.CornerRadius = UDim.new(0, 8)
ServerInfoCorner.Parent = ServerInfoFrame

-- Server Version Display
local VersionText = Instance.new("TextLabel")
VersionText.Name = "VersionText"
VersionText.Text = "Version: " .. CurrentPlaceVersion
VersionText.Size = UDim2.new(1, 0, 0.5, 0)
VersionText.Position = UDim2.new(0, 10, 0, 5)
VersionText.BackgroundTransparency = 1
VersionText.TextColor3 = Color3.fromRGB(150, 255, 150)
VersionText.Font = Enum.Font.Gotham
VersionText.TextSize = 12
VersionText.TextXAlignment = Enum.TextXAlignment.Left
VersionText.Parent = ServerInfoFrame

-- Server Hop Button
local ServerHopButton = Instance.new("TextButton")
ServerHopButton.Name = "ServerHopButton"
ServerHopButton.Text = "SERVER HOP (H)"
ServerHopButton.Size = UDim2.new(0.8, 0, 0, 30)
ServerHopButton.Position = UDim2.new(0.1, 0, 0.5, 5)
ServerHopButton.BackgroundColor3 = Color3.fromRGB(80, 120, 200)
ServerHopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ServerHopButton.Font = Enum.Font.GothamBold
ServerHopButton.TextSize = 14
ServerHopButton.Parent = ServerInfoFrame

local ServerHopCorner = Instance.new("UICorner")
ServerHopCorner.CornerRadius = UDim.new(0, 6)
ServerHopCorner.Parent = ServerHopButton

-- Settings Section
local SettingsFrame = Instance.new("Frame")
SettingsFrame.Name = "SettingsFrame"
SettingsFrame.Size = UDim2.new(0.9, 0, 0, 80)
SettingsFrame.Position = UDim2.new(0.05, 0, 0, 495)
SettingsFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
SettingsFrame.BorderSizePixel = 0
SettingsFrame.Parent = ContentFrame

local SettingsCorner = Instance.new("UICorner")
SettingsCorner.CornerRadius = UDim.new(0, 8)
SettingsCorner.Parent = SettingsFrame

-- Hold E Time Slider
local HoldEText = Instance.new("TextLabel")
HoldEText.Name = "HoldEText"
HoldEText.Text = "Hold E Time: " .. HOLD_E .. "s"
HoldEText.Size = UDim2.new(1, 0, 0.5, 0)
HoldEText.Position = UDim2.new(0, 10, 0, 5)
HoldEText.BackgroundTransparency = 1
HoldEText.TextColor3 = Color3.fromRGB(255, 255, 255)
HoldEText.Font = Enum.Font.Gotham
HoldEText.TextSize = 12
HoldEText.TextXAlignment = Enum.TextXAlignment.Left
HoldEText.Parent = SettingsFrame

local HoldESlider = Instance.new("TextBox")
HoldESlider.Name = "HoldESlider"
HoldESlider.Text = tostring(HOLD_E)
HoldESlider.Size = UDim2.new(0.8, 0, 0, 25)
HoldESlider.Position = UDim2.new(0.1, 0, 0.5, 5)
HoldESlider.BackgroundColor3 = Color3.fromRGB(70, 70, 90)
HoldESlider.TextColor3 = Color3.fromRGB(255, 255, 255)
HoldESlider.Font = Enum.Font.Gotham
HoldESlider.TextSize = 12
HoldESlider.PlaceholderText = "Hold time in seconds"
HoldESlider.Parent = SettingsFrame

local HoldECorner = Instance.new("UICorner")
HoldECorner.CornerRadius = UDim.new(0, 4)
HoldECorner.Parent = HoldESlider

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Text = "X"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 10)
CloseButton.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 16
CloseButton.Parent = MainFrame

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 15)
CloseCorner.Parent = CloseButton

-- Minimize Button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Text = "_"
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -70, 0, 10)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(70, 70, 90)
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 16
MinimizeButton.Parent = MainFrame

local MinimizeCorner = Instance.new("UICorner")
MinimizeCorner.CornerRadius = UDim.new(0, 15)
MinimizeCorner.Parent = MinimizeButton

-- Drag functionality
local dragging
local dragInput
local dragStart
local startPos

local function updateInput(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        updateInput(input)
    end
end)

-- GUI Functions
local function updateStatus(status, color)
    StatusLabel.Text = "STATUS: " .. status
    StatusLabel.TextColor3 = color
end

local function updateProgress(current, total, itemName)
    ProgressText.Text = "Progress: " .. current .. "/" .. total
    CurrentItemText.Text = "Current: " .. (itemName or "None")
end

-- Check if item is blacklisted
local function isBlacklisted(itemName)
    for _, blacklisted in ipairs(BLACKLIST) do
        if string.find(itemName:lower(), blacklisted:lower()) then
            return true
        end
    end
    return false
end

-- Auto equip bat function (FAST 0.1s)
local function autoEquipBat()
    if not character or not character:FindFirstChild("Humanoid") then
        return false
    end
    
    -- Check if already has bat equipped
    local hasBat = false
    for _, item in ipairs(character:GetChildren()) do
        if item:IsA("Tool") and item.Name:lower():find("bat") then
            hasBat = true
            break
        end
    end
    
    if hasBat then
        return false -- Already has bat
    end
    
    -- Check backpack exists
    if not backpack or not backpack:IsDescendantOf(game) then
        backpack = player:WaitForChild("Backpack")
    end
    
    -- Look for bats in backpack
    local bats = {}
    for _, item in ipairs(backpack:GetChildren()) do
        if item:IsA("Tool") then
            local itemName = item.Name:lower()
            if itemName:find("bat") then
                table.insert(bats, item)
            end
        end
    end
    
    if #bats > 0 then
        -- Equip the first bat found
        local bat = bats[1]
        local success = pcall(function()
            local humanoid = character.Humanoid
            -- Unequip any current tools first
            humanoid:UnequipTools()
            task.wait(0.01) -- Small delay
            humanoid:EquipTool(bat)
        end)
        
        if success then
            warn("[AUTO EQUIP] Equipped: " .. bat.Name)
            
            -- Update GUI status
            AutoEquipText.Text = "Auto Equip Bat: EQUIPPED"
            AutoEquipText.TextColor3 = Color3.fromRGB(100, 255, 100)
            return true
        else
            warn("[AUTO EQUIP] Failed to equip bat")
            return false
        end
    else
        -- No bats found
        AutoEquipText.Text = "Auto Equip Bat: NO BAT"
        AutoEquipText.TextColor3 = Color3.fromRGB(255, 200, 50)
        return false
    end
end

-- Auto jump function
local function autoJump()
    if not character or not character:FindFirstChild("Humanoid") then
        return false
    end
    
    local humanoid = character.Humanoid
    
    -- Check if character can jump (not dead, etc.)
    if humanoid.Health <= 0 then
        return false
    end
    
    -- Press and release space bar once
    warn("[AUTO-JUMP] Jumping to prevent AFK...")
    
    VIM:SendKeyEvent(true, Enum.KeyCode.Space, false, game)
    task.wait(0.1) -- Hold space for 0.1 seconds
    VIM:SendKeyEvent(false, Enum.KeyCode.Space, false, game)
    
    -- Update GUI status
    AutoJumpText.Text = "Auto Jump (10min): JUMPED"
    AutoJumpText.TextColor3 = Color3.fromRGB(100, 255, 100)
    
    -- Show notification
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "üöÄ Auto-Jump",
        Text = "Jumped to prevent AFK",
        Duration = 3,
        Icon = "rbxassetid://6726673526"
    })
    
    warn("[AUTO-JUMP] Jump completed. Next jump in " .. AUTO_JUMP_INTERVAL .. " seconds")
    
    -- Reset status after delay
    task.delay(2, function()
        if AUTO_JUMP_ENABLED then
            AutoJumpText.Text = "Auto Jump (10min): ACTIVE"
            AutoJumpText.TextColor3 = Color3.fromRGB(255, 200, 50)
        end
    end)
    
    return true
end

-- SIMPLIFIED Auto accept trade function - ONLY ENTER
local function autoAcceptTrade()
    -- Simply press Enter key
    VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
    task.wait(0.05)
    VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
    
    -- Update GUI status
    AutoTradeText.Text = "Auto Accept Trade: PRESSED"
    AutoTradeText.TextColor3 = Color3.fromRGB(100, 255, 100)
    
    warn("[AUTO TRADE] Enter key pressed")
    
    -- Show brief notification
    task.spawn(function()
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "ü§ù Enter Pressed",
            Text = "Auto pressed Enter key",
            Duration = 0.5,
            Icon = "rbxassetid://6726673526"
        })
    end)
    
    -- Reset status after delay
    task.delay(0.5, function()
        if AUTO_TRADE_ENABLED then
            AutoTradeText.Text = "Auto Accept Trade: ACTIVE"
            AutoTradeText.TextColor3 = Color3.fromRGB(255, 200, 50)
        end
    end)
end

-- Toggle auto equip bat
local function toggleAutoEquipBat()
    AUTO_EQUIP_BAT_ENABLED = not AUTO_EQUIP_BAT_ENABLED
    
    if AUTO_EQUIP_BAT_ENABLED then
        AutoEquipToggle.Text = "ON"
        AutoEquipToggle.BackgroundColor3 = Color3.fromRGB(70, 180, 90)
        AutoEquipText.Text = "Auto Equip Bat: ACTIVE"
        AutoEquipText.TextColor3 = Color3.fromRGB(255, 200, 50)
        warn("[AUTO EQUIP] Auto equip bat enabled (0.1s interval)")
    else
        AutoEquipToggle.Text = "OFF"
        AutoEquipToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
        AutoEquipText.Text = "Auto Equip Bat: OFF"
        AutoEquipText.TextColor3 = Color3.fromRGB(255, 100, 100)
        warn("[AUTO EQUIP] Auto equip bat disabled")
    end
end

-- Toggle auto trade
local function toggleAutoTrade()
    AUTO_TRADE_ENABLED = not AUTO_TRADE_ENABLED
    
    if AUTO_TRADE_ENABLED then
        AutoTradeToggle.Text = "ON"
        AutoTradeToggle.BackgroundColor3 = Color3.fromRGB(70, 180, 90)
        AutoTradeText.Text = "Auto Accept Trade: ACTIVE"
        AutoTradeText.TextColor3 = Color3.fromRGB(255, 200, 50)
        warn("[AUTO TRADE] Auto accept trade enabled (Enter key only)")
    else
        AutoTradeToggle.Text = "OFF"
        AutoTradeToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
        AutoTradeText.Text = "Auto Accept Trade: OFF"
        AutoTradeText.TextColor3 = Color3.fromRGB(255, 100, 100)
        warn("[AUTO TRADE] Auto accept trade disabled")
    end
end

-- Toggle auto jump
local function toggleAutoJump()
    AUTO_JUMP_ENABLED = not AUTO_JUMP_ENABLED
    
    if AUTO_JUMP_ENABLED then
        AutoJumpToggle.Text = "ON"
        AutoJumpToggle.BackgroundColor3 = Color3.fromRGB(70, 180, 90)
        AutoJumpText.Text = "Auto Jump (10min): ACTIVE"
        AutoJumpText.TextColor3 = Color3.fromRGB(255, 200, 50)
        warn("[AUTO-JUMP] Auto jump enabled (every 10 minutes)")
    else
        AutoJumpToggle.Text = "OFF"
        AutoJumpToggle.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
        AutoJumpText.Text = "Auto Jump (10min): OFF"
        AutoJumpText.TextColor3 = Color3.fromRGB(255, 100, 100)
        warn("[AUTO-JUMP] Auto jump disabled")
    end
end

-- Button Functions
ToggleButton.MouseButton1Click:Connect(function()
    ENABLED = not ENABLED
    
    if ENABLED then
        updateStatus("RUNNING", Color3.fromRGB(100, 255, 100))
        ToggleButton.Text = "STOP (G)"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(220, 70, 70)
        warn("[AUTO-GIFT] Started")
    else
        updateStatus("PAUSED", Color3.fromRGB(255, 200, 50))
        ToggleButton.Text = "START (G)"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(70, 180, 90)
        warn("[AUTO-GIFT] Paused")
    end
end)

AutoEquipToggle.MouseButton1Click:Connect(function()
    toggleAutoEquipBat()
end)

AutoTradeToggle.MouseButton1Click:Connect(function()
    toggleAutoTrade()
end)

AutoJumpToggle.MouseButton1Click:Connect(function()
    toggleAutoJump()
end)

ServerHopButton.MouseButton1Click:Connect(function()
    serverHop()
end)

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    return
end)

MinimizeButton.MouseButton1Click:Connect(function()
    if MainFrame.Size.Y.Offset == 450 then
        MainFrame:TweenSize(UDim2.new(0, 350, 0, 50), "Out", "Quad", 0.3, true)
        MinimizeButton.Text = "+"
    else
        MainFrame:TweenSize(UDim2.new(0, 350, 0, 450), "Out", "Quad", 0.3, true)
        MinimizeButton.Text = "_"
    end
end)

HoldESlider.FocusLost:Connect(function()
    local num = tonumber(HoldESlider.Text)
    if num and num >= 0.1 and num <= 5 then
        HOLD_E = num
        HoldEText.Text = "Hold E Time: " .. HOLD_E .. "s"
        warn("[SETTINGS] Hold E time set to " .. HOLD_E .. " seconds")
    else
        HoldESlider.Text = tostring(HOLD_E)
    end
end)

-- Keyboard shortcuts
UIS.InputBegan:Connect(function(input, gp)
    if gp then return end
    
    if input.KeyCode == Enum.KeyCode.G then
        ToggleButton:Activate()
    end
    
    if input.KeyCode == Enum.KeyCode.H then
        ServerHopButton:Activate()
    end
    
    if input.KeyCode == Enum.KeyCode.F then
        AutoEquipToggle:Activate()
        warn("[AUTO EQUIP] F key pressed - Toggled auto equip bat")
    end
    
    if input.KeyCode == Enum.KeyCode.T then
        AutoTradeToggle:Activate()
        warn("[AUTO TRADE] T key pressed - Toggled auto accept trade")
    end
    
    if input.KeyCode == Enum.KeyCode.J then
        AutoJumpToggle:Activate()
        warn("[AUTO-JUMP] J key pressed - Toggled auto jump")
    end
end)

-- Auto Equip Bat Loop (FAST 0.1s)
task.spawn(function()
    while true do
        if AUTO_EQUIP_BAT_ENABLED then
            local currentTime = tick()
            if currentTime - lastEquipCheck >= AUTO_EQUIP_INTERVAL then
                lastEquipCheck = currentTime
                
                -- Check if character is valid
                if character and character:FindFirstChild("Humanoid") then
                    autoEquipBat()
                end
            end
        end
        task.wait(0.01) -- Check every 0.01 seconds (very fast)
    end
end)

-- Auto Jump Loop
task.spawn(function()
    task.wait(5) -- Initial delay
    
    while true do
        if AUTO_JUMP_ENABLED then
            local currentTime = tick()
            
            -- Check if it's time to jump
            if currentTime - lastJumpTime >= AUTO_JUMP_INTERVAL then
                lastJumpTime = currentTime
                
                -- Perform the jump
                autoJump()
                
                -- Small cooldown after jump
                task.wait(2)
            end
        end
        
        -- Check every minute to save resources
        task.wait(60)
    end
end)

-- SIMPLIFIED Auto Trade Accept Loop
task.spawn(function()
    while true do
        if AUTO_TRADE_ENABLED then
            local currentTime = tick()
            if currentTime - lastTradeCheck >= AUTO_TRADE_INTERVAL then
                lastTradeCheck = currentTime
                
                -- Execute SIMPLIFIED trade accept (just Enter)
                autoAcceptTrade()
            end
        end
        task.wait(0.05) -- Check very frequently
    end
end)

-- Server functions
local function checkGameVersion()
    if not VersionCheckEnabled then return end
    
    local currentVersion = game.PlaceVersion
    if LastKnownVersion and LastKnownVersion ~= currentVersion then
        VersionText.Text = "Version: " .. currentVersion .. " (CHANGED!)"
        VersionText.TextColor3 = Color3.fromRGB(255, 100, 100)
        
        game:GetService("StarterGui"):SetCore("SendNotification", {
            Title = "‚ö†Ô∏è Game Updated",
            Text = "Game version changed from " .. LastKnownVersion .. " to " .. currentVersion,
            Duration = 10,
            Icon = "rbxassetid://6726673526"
        })
        
        warn("[VERSION CHECK] Game version changed! Old: " .. LastKnownVersion .. " | New: " .. currentVersion)
        warn("[VERSION CHECK] Script might need updating!")
    else
        VersionText.Text = "Version: " .. currentVersion
        VersionText.TextColor3 = Color3.fromRGB(150, 255, 150)
    end
    
    LastKnownVersion = currentVersion
end

local function getServerInfo()
    local players = #Players:GetPlayers()
    VersionText.Text = "Version: " .. CurrentPlaceVersion .. " | Players: " .. players
end

local function serverHop()
    if ServerHopCooldown then
        warn("[SERVER HOP] Cooldown active. Please wait.")
        return
    end
    
    ServerHopCooldown = true
    local originalText = ServerHopButton.Text
    ServerHopButton.Text = "HOPPING..."
    ServerHopButton.BackgroundColor3 = Color3.fromRGB(120, 80, 200)
    
    warn("[SERVER HOP] Attempting to server hop...")
    
    local function getRandomServer()
        local servers = {}
        local success, result = pcall(function()
            local response = game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceId .. "/servers/Public?limit=100")
            return HttpService:JSONDecode(response)
        end)
        
        if success and result and result.data then
            for _, server in ipairs(result.data) do
                if server.id ~= JobId and server.playing < server.maxPlayers then
                    table.insert(servers, server)
                end
            end
            
            if #servers > 0 then
                local randomServer = servers[math.random(1, #servers)]
                return randomServer.id
            end
        end
        return nil
    end
    
    local serverId = getRandomServer()
    if serverId then
        warn("[SERVER HOP] Found server. Teleporting...")
        
        local teleportSuccess = pcall(function()
            TeleportService:TeleportToPlaceInstance(PlaceId, serverId, player)
        end)
        
        if not teleportSuccess then
            warn("[SERVER HOP] Teleport failed. Trying alternative method...")
            TeleportService:Teleport(PlaceId, player)
        end
    else
        warn("[SERVER HOP] No servers found. Using default teleport...")
        TeleportService:Teleport(PlaceId, player)
    end
    
    task.delay(5, function()
        ServerHopCooldown = false
        ServerHopButton.Text = originalText
        ServerHopButton.BackgroundColor3 = Color3.fromRGB(80, 120, 200)
    end)
end

-- Character validity check
local function isCharacterValid()
    if not character or not character:IsDescendantOf(game) then
        character = player.Character
        return false
    end
    
    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then return false end
    
    return humanoid.Health > 0
end

-- Main gifting loop
task.spawn(function()
    local totalGifted = 0
    
    while true do
        if ENABLED then
            character = player.Character or character
            
            if SAFETY_CHECK and not isCharacterValid() then
                updateProgress(0, 0, "Waiting for character...")
                task.wait(1)
                continue
            end
            
            -- Check backpack exists
            if not backpack or not backpack:IsDescendantOf(game) then
                backpack = player:WaitForChild("Backpack")
            end
            
            -- Get giftable tools (exclude bats)
            local tools = {}
            for _, item in ipairs(backpack:GetChildren()) do
                if item:IsA("Tool") and not isBlacklisted(item.Name) then
                    -- Check if it's a bat
                    if not item.Name:lower():find("bat") then
                        table.insert(tools, item)
                    end
                end
            end
            
            if #tools == 0 then
                updateProgress(0, 0, "No giftable items found")
                task.wait(2)
            else
                updateProgress(0, #tools, "Starting gift cycle...")
                warn("[AUTO-GIFT] Starting gift cycle with " .. #tools .. " items")
                
                for i, tool in ipairs(tools) do
                    if not ENABLED then break end
                    
                    -- Check character validity before each gift
                    if SAFETY_CHECK and not isCharacterValid() then
                        updateProgress(i-1, #tools, "Character invalid, waiting...")
                        task.wait(2)
                        break
                    end
                    
                    updateProgress(i, #tools, tool.Name)
                    
                    -- Equip tool with error handling
                    local equipSuccess = pcall(function()
                        local humanoid = character:FindFirstChild("Humanoid")
                        if humanoid then
                            humanoid:EquipTool(tool)
                            task.wait(0.2) -- Wait for equip animation
                        end
                    end)
                    
                    if not equipSuccess then
                        warn("[AUTO-GIFT] Failed to equip: " .. tool.Name)
                        updateProgress(i, #tools, "Failed to equip: " .. tool.Name)
                        task.wait(0.5)
                        continue
                    end
                    
                    -- Hold E to gift
                    VIM:SendKeyEvent(true, Enum.KeyCode.E, false, game)
                    task.wait(HOLD_E)
                    VIM:SendKeyEvent(false, Enum.KeyCode.E, false, game)
                    
                    totalGifted = totalGifted + 1
                    warn("[AUTO-GIFT] Gifted: " .. tool.Name .. " (" .. i .. "/" .. #tools .. ")")
                    
                    -- Wait cooldown
                    task.wait(COOLDOWN)
                end
                
                if ENABLED then
                    updateProgress(#tools, #tools, "Cycle Complete!")
                    warn("[AUTO-GIFT] Cycle complete. Total gifted: " .. totalGifted)
                    task.wait(1) -- Brief pause before next cycle
                end
            end
        else
            updateProgress(0, 0, "Idle")
        end
        task.wait(0.5)
    end
end)

-- Connection to character changes
player.CharacterAdded:Connect(function(newChar)
    character = newChar
    task.wait(1) -- Wait for character to fully load
    
    -- Reset auto equip status on character respawn
    if AUTO_EQUIP_BAT_ENABLED then
        AutoEquipText.Text = "Auto Equip Bat: CHECKING..."
        AutoEquipText.TextColor3 = Color3.fromRGB(255, 200, 50)
        
        -- Auto equip bat after character loads
        task.delay(0.5, function()
            autoEquipBat()
        end)
    end
end)

-- Periodic version check
task.spawn(function()
    task.wait(5) -- Initial delay
    while true do
        checkGameVersion()
        getServerInfo()
        task.wait(30)
    end
end)

-- Initialize
LastKnownVersion = CurrentPlaceVersion
updateStatus("OFF", Color3.fromRGB(255, 100, 100))
updateProgress(0, 0, "Ready")
checkGameVersion()
getServerInfo()

warn("==========================================")
warn("[AUTO GIFT] Script loaded successfully!")
warn("[CONTROLS] G = Toggle Gift")
warn("[CONTROLS] F = Toggle Auto Equip Bat | T = Toggle Auto Accept Trade")
warn("[CONTROLS] J = Toggle Auto Jump | H = Server Hop")
warn("[AUTO EQUIP] Will auto-equip bat every 0.1 seconds (FAST)")
warn("[AUTO TRADE] Will auto-press Enter every 0.4 seconds")
warn("[AUTO JUMP] Will auto-jump every 10 minutes (AFK prevention)")
warn("[GUI] Now scrollable! Scroll to see all features")
warn("[VERSION] Game Version: " .. CurrentPlaceVersion)
warn("==========================================")
